SDK 接入文档

+:---------+:-----------+:----------------------------------------------+
| > 版本号 | > 修改时间 | > 内容                                        |
+----------+------------+-----------------------------------------------+
| 2.2.0    | 2023-04-10 | **升级oaid，兼容不同oaid的aar**               |
|          |            |                                               |
|          |            | **升级头条事件管理6.14.3 SDK**                |
|          |            |                                               |
|          |            | **依赖导入修改**                              |
+----------+------------+-----------------------------------------------+
| 2.2.5    | 2023-07-17 | **隐私政策oaid修改**                          |
|          |            |                                               |
|          |            | **升级到热云1.9.3**                           |
|          |            |                                               |
|          |            | **模拟器识别优化**                            |
|          |            |                                               |
|          |            | **新增快手分包**                              |
|          |            |                                               |
|          |            | **新增悬浮球红包功能**                        |
+----------+------------+-----------------------------------------------+
| 2.2.6    | 2023-08-02 | **生命周期onResume需要传入参数activity**      |
+----------+------------+-----------------------------------------------+
| 2.2.12   | 2024-01-25 | **添加支付异常信息回调**                      |
+----------+------------+-----------------------------------------------+
| 2.2.18   | 2024-08-28 | **授权新增数数回调**                          |
+----------+------------+-----------------------------------------------+
| 2.2.28   | 2025-03-12 | **新增微信登录成功返回参数**                  |
+----------+------------+-----------------------------------------------+
| 2.2.30   | 2025-04-16 | **百度流更新到v2.7.2**                        |
+----------+------------+-----------------------------------------------+

# 目录

目录

[1. 概述 5](#概述)

[2.接入流程 5](#接入流程)

[2.1 申请应用配置 5](#申请应用配置)

[2.2 导入SDK依赖 5](#导入sdk依赖)

[2.2.1 依赖导入 5](#依赖导入)

[2.2.2 依赖冲突解决 6](#依赖库冲突解决)

[2.3 build配置 7](#_2.2.4_修改_assets)

[3 接口说明 8](#_2.3.5_添加meta-data)

[3.1 Application初始化接口 8](#_Toc19411)

[3.2 授权接口 8](#_Toc12590)

[3.3 登录接口 9](#授权接口)

[3.4 支付接口 9](#回调类authcallback)

[3.5 角色提交信息接口 1](#_Toc16869)0

[3.6 应用退出接口 1](#获取角色信息类usergamerolerequest)0

[3.7 注销登录接口 1](#提交角色信息接口)1

[3.8 切换登录接口 1](#_Toc28831)1

[3.9 生命周期 1](#_Toc5284)1

[4 注意事项 1](#注意事项)6

[5.1 所有 SDK 接口调用 都需要在调用初始化、授权接口成功以后才能继续执行
1](#所有-sdk-接口调用-都需要在调用application初始化授权接口成功以后才能继续执行)6

[5.2 接口请在主线程调用 1](#接口请在主线程调用)6

[5.3 Apk请勿加固 1](#apk请勿加固)6

[5.4 如遇到因权限问题造成APP闪退，则请将编译版本改为28 1](#_Toc11779)6

# 概述

本文档面向安卓开发者，用于指导开发者快速接入SDK，提供多个接口给集成者调用。

重要提醒：

**所有的 SDK 操作都必须在应用成功授权之后才能继续执行**

# 接入流程

## 申请应用配置

开发者需要向浩凡SDK运营人员索取出包物料（请勿直接使用demo中的参数）

物料包必要参数：

> [游戏pid，游戏名称，金额单位]{.mark}

## 导入SDK依赖

### 建议开发环境

开发工具：要求使用Android Studio
3.0版本及以上，Gradle版本建议5.4.1版本及以上，Gradle插件（Android gradle
plugin）版本建议3.2.2版本及以上；

SDK支持版本：最低支持Android
5.0以上版本（minSdkVersion\>=21，targetSdkVersion 30）；

### 依赖导入

注：2.2.1版本开始需要支持androidx环境（引用：implementation
\'androidx.appcompat:appcompat:\${version2}\'）

如果开发环境是Android studio的话，直接将 SDK 包内的 libs
目录下的文件（夹）放到应用工程的 libs 目录下.

注：1、如果开发环境为eclipse的话，需将libs的AAR文件解压，并将解压后的文件拷贝到各自的文件夹下。

+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| dependencies ***{***                                                                                                                                                                                    |
|                                                                                                                                                                                                         |
| > ***注：//system和vesion查看Demo中libs***                                                                                                                                                              |
| >                                                                                                                                                                                                       |
| > ***implementation files(\'libs/\${system}\_SDK\_\${version}.aar\')***                                                                                                                                 |
| >                                                                                                                                                                                                       |
| > ***implementation files(\'libs/oaid_sdk\_\${version1}.aar\')***                                                                                                                                       |
| >                                                                                                                                                                                                       |
| > ***implementation files(\'libs/xinji-sdk-base\_\${version2}.aar\')***                                                                                                                                 |
| >                                                                                                                                                                                                       |
| > ***implementation \'androidx.appcompat:appcompat:\${version3}\'***                                                                                                                                    |
| >                                                                                                                                                                                                       |
| > ***}***                                                                                                                                                                                               |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ***2.如果开发者项目本身未使用kotlin部分，则必须通过implementation远程依赖的形式进行kotlin的依赖（如果跳过此步会造成头条事件管理SDK功能闪退）；如果开发者项目本身包含kotlin部分，则需要保证版本兼容。*** |
|                                                                                                                                                                                                         |
| ***implementation \'org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.3.61\'***                                                                                                                                 |
|                                                                                                                                                                                                         |
| ***引用成功如下:***                                                                                                                                                                                     |
|                                                                                                                                                                                                         |
| ![](media/image1.png)                                                                                                                                                                                   |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

### 依赖库冲突解决

该SDK的AAR包已将其他第三方库的jar包都合并此AAR包中，为了避免接入时，导入相同的依赖库而造成冲突。特此列出已支持的第三方依赖库，CP可对比自己项目下的依赖库来解决冲突：

已支持依赖库列表（项目中无需再添加下面依赖）：

+-----------------------------------------------------------------------+
| dependencies                                                          |
|                                                                       |
| */ 安卓X依赖*                                                         |
|                                                                       |
| **implementation files*(*\'libs/android.core-1.1.0.jar\'*)***         |
|                                                                       |
| **implementation files*(*\'libs/annotation-1.1.0.jar\'*)***           |
|                                                                       |
| **implementation files*(*\'libs/fragment-1.1.0.jar\'*)***             |
|                                                                       |
| **implementation files*(*\'libs/viewpager-1.0.0.jar\'*)***            |
|                                                                       |
| **implementation files*(*\'libs/recyclerview-1.1.0.jar\'*)***         |
|                                                                       |
| ***/ SDK***                                                           |
|                                                                       |
| **implementation files*(*\'libs/Union_SDK_U.1.6.0_Multi.jar\'*)***    |
|                                                                       |
| **implementation files*(*\'libs/bcprov-jdk16-139.jar\'*)***           |
|                                                                       |
| **implementation*(*name: \'bdlite-5.2.4-alpha.0\', ext: \'aar\'*)***  |
|                                                                       |
| **implementation*(*name: \'GDTActionSDK.min.1.6.5\', ext:             |
| \'aar\'*)***                                                          |
|                                                                       |
| **implementation*(*name: \'monitorsdk-1.0.4\', ext: \'aar\'*)***      |
|                                                                       |
| **implementation*(*name: \'sdk_gism-1.3.2\', ext: \'aar\'*)***        |
|                                                                       |
| **implementation*(*name: \'oaid_sdk_1.0.25\', ext: \'aar\'*)***       |
|                                                                       |
| ***implementation                                                     |
| files(\'libs/PRODUCT_complete_snda-woaandroid-2.5.1.1-18962.jar\')*** |
|                                                                       |
| ***implementation files(\'libs/universal-image-loader-1.9.5.jar\')*** |
|                                                                       |
| ***/ 头条包***                                                        |
|                                                                       |
| ***implementation (name: \'bdlite-5.2.4-alpha.0\', ext: \'aar\')***   |
|                                                                       |
| ***implementation(name: \'GDTActionSDK.min.1.6.5\', ext: \'aar\')***  |
|                                                                       |
| ***implementation(name: \'monitorsdk-1.0.4\', ext: \'aar\')***        |
|                                                                       |
| ***implementation(name: \'captcha-release\', ext: \'aar\')***         |
|                                                                       |
| ***implementation(name: \'sdk_gism-1.3.2\', ext: \'aar\')***          |
|                                                                       |
| ***implementation(name: \'oaid_sdk_1.0.25\', ext: \'aar\')***         |
|                                                                       |
| ***/易盾一键登录***                                                   |
|                                                                       |
| ***implementation(name: \'quicklogin_libary-external-release-3.0.2\', |
| ext: \'aar\')***                                                      |
|                                                                       |
| ***implementation(name: \'CMCCSSOSDK-WY-release\', ext: \'aar\')***   |
|                                                                       |
| ***implementation(name: \'Ui-factory_oauth_mobile_3.9.1.8\', ext:     |
| \'aar\')***                                                           |
|                                                                       |
| ***implementation(name: \'CTAccount_sdk_api_v3.8.3_all_wy\', ext:     |
| \'aar\')***                                                           |
|                                                                       |
| ***implementation(name: \'base-sdk-libary-release\', ext: \'aar\')*** |
|                                                                       |
| ***implementation(name: \'quicklogin_libary-external-release-3.0.2\', |
| ext: \'aar\')***                                                      |
|                                                                       |
| ***implementation(name: \'CMCCSSOSDK-WY-release\', ext: \'aar\')***   |
|                                                                       |
| ***implementation(name: \'Ui-factory_oauth_mobile_3.9.1.8\', ext:     |
| \'aar\')***                                                           |
|                                                                       |
| ***implementation(name: \'CTAccount_sdk_api_v3.8.3_all_wy\', ext:     |
| \'aar\')***                                                           |
|                                                                       |
| ***implementation(name: \'base-sdk-libary-release\', ext: \'aar\')*** |
|                                                                       |
| ***compile files(\'libs/android-logging-log4j-1.0.3.jar\')***         |
|                                                                       |
| ***compile files(\'libs/log4j-1.2.17.jar\')***                        |
|                                                                       |
| ***implementation files(\'libs/httpmime-4.3.6.jar\')***               |
|                                                                       |
| ***implementation files(\'libs/httpcore-4.4.1.jar\')***               |
|                                                                       |
| ***compile(name: \'humesdk-1.0.0\', ext: \'aar\')***                  |
|                                                                       |
| ***implementation(name: \'Baidu_ocpc_action_2_4\', ext: \'aar\')***   |
|                                                                       |
| ***implementation files(\'libs/common-2.0.3.jar\')***                 |
|                                                                       |
| ***implementation files(\'libs/reader-2.0.3.jar\')***                 |
|                                                                       |
| ***implementation(name: \'quick_login_android_5.9.3\', ext:           |
| \'aar\')***                                                           |
+-----------------------------------------------------------------------+
|                                                                       |
+-----------------------------------------------------------------------+

[]{#_2.2.4_修改_assets .anchor}

##  build 配置

在应用下build.gradle 下的defaultConfig中添加:

注：NDK配置根据项目对平台的选择进行合理适配

defaultConfig **{**

manifestPlaceholders.put(\"APPLOG_SCHEME\",\"rangersapplog.byAx6uYt\".toLowerCase())

ndk**{**

abiFilters \'armeabi-v7a\' ,\'armeabi\' ,\'arm64-v8a\',\'x86\',
\'x86_64\'

**}**

**}**

[]{#_2.3.5_添加meta-data .anchor}在应用下build.gradle
下的packagingOptions中添加：

packagingOptions {

doNotStrip *\"\*/armeabi-v7a/\*.so\"*

doNotStrip *\"\*/x86/\*.so\"*

doNotStrip *\"\*/arm64-v8a/\*.so\"*

doNotStrip *\"\*/x86_64/\*.so\"*

doNotStrip *\"armeabi.so\"*

}

## 配置应用参数

### 抖音数据采集（如不接可忽略此步骤）

**系统要求**

\- Android abi 限制：请不要限制 abiFilters 仅为
armeabi，否则可能出现功能异常，请至少保留 armeabi-v7a

\- 多 dex 设置：在 Application 或 Library 模块 build.gradle
文件中配置multiDexEnabled true以支持多 dex

\- 特别注意：游戏包体的 VersionCode 以及 VersionName
必须设置，不要留空。VersionName 建议为两点三段式，其中每段均为数字，例如
3.4.5。VersionName
不要有特殊字符，比如(、)，避免因为版本名称解析失败导致无法通过数据检测。

**config.json**由运营提供

将config.json移入assets文件夹下

![](media/image2.png)

**通过抖音打开游戏**

**1.配置 Activity 接收抖音打开游戏调用的 scheme**

1.抖音打开游戏功能会通过 scheme 拉起游戏的 Activity，游戏侧需要增加相应
Activiy 配置以响应该 scheme。其中 \"android:exported\" 必须设置为 true。

2.建议的 scheme
标准格式如下所示(参考\<data\>部分)，如果有特殊原因不能采用如下标准格式，请按实际跟抖音游戏侧约定的格式进行配置（强烈建议使用标准格式，减少出错概率）。

\${appid} 请替换为 config.json 中配置的 app_id

\${applicationId} 无需修改，Android gradle
在构建时会自动将其替换为你的游戏的包名

配置完成后可响应抖音打开游戏的scheme，示例：

dygame123456://your.pkg.name/jump_to_game?dygame_log_extra=%7B%22link_id%22%3A%22abcdefg%22%7D

**2.处理从抖音接收到的 scheme**

**接口说明**

该接口调用不依赖抖音游戏双通SDK初始化，在上一步配置的 XXGameActivity
中获取到 scheme 时调用此接口即可。

请在 Activity 的 onCreate 中尽早调用，建议早于
XJGame.authorization(\...) 方法的调用

**参数以及回调结果说明**

+------------+--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **变量名** | **字段类型** | **字段说明**                                                                                                                                                      |
+:===========+:=============+:==================================================================================================================================================================+
| url        | String       | 1.抖音拉起游戏的 Activity 后，通过 Intent.getData() 获取到 Uri 并 toString 处理的scheme 值                                                                        |
|            |              |                                                                                                                                                                   |
|            |              | 2.在 Activity 的 onCreate 方法与 onNewIntent 方法中均需要处理                                                                                                     |
+------------+--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 返回值     | boolean      | 1.true:                                                                                                                                                           |
|            |              | 该scheme匹配抖音打开游戏的统一scheme格式，SDK内部会自行解析所需要数据。一般不需要额外处理，如果你需要解析scheme中携带的参数，请按照跟抖音业务侧约定的协议自行解析 |
|            |              |                                                                                                                                                                   |
|            |              | 2.false: 该scheme不匹配抖音打开游戏的统一scheme格式，SDK不关心该scheme的数据，请自行处理                                                                          |
+------------+--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+

**代码示例**

### **百度流事件管理(如不接可忽略此步骤)**

Mainfest配置

  -----------------------------------------------------------------------
  \<!\--百度流SDK应用ID\--\>\
  \<meta-data\
  android:name=\"baiduAppKey\"\
  android:value=\"运营提供\" /\>\
  \<!\--百度流SDK应用密钥\--\>\
  \<meta-data\
  android:name=\"baiduSecretKey\"\
  android:value=\"运营提供\" /\>

  -----------------------------------------------------------------------

# 接口说明

##  Application初始化接口

此接口必须在APP刚启动时，一般为Application的onCreate

**注意：** 调用方法如下：

  -----------------------------------------------------------------------
  XJGame.*onCreate*(Application application);

  -----------------------------------------------------------------------

接口所需参数：

  -------------------- --------------- ----------------------------------
  参数                 是否可空        描述

  Application          否              环境上下文
  application                          
  -------------------- --------------- ----------------------------------

##  授权接口 

### 描述

此接口必须在登录之前调用，用于给当前APP授权，授权成功后才可以进行登录和支付。

**注意：**

**XJGame.authorization接口中传入的Activity不可被销毁，否则会产生Crash**

调用方法如下：

  -----------------------------------------------------------------------
  XJGame.authorization(Activity mContext, HashMap\<String,String\>
  dataMap, AuthCallBack callback);

  -----------------------------------------------------------------------

接口所需参数：

  ----------------------- ----------------------- --------------------------------
           参数                  可否为空                       描述

     Activity activity            不可以                       上下文

          Map map                 不可以                    传递授权参数

   AuthCallBack callBack          不可以           授权回调对象，用于处理授权结果
  ----------------------- ----------------------- --------------------------------

Map参数说明

+:---------------------:+:--------------------------:+:---------+:---------------------------------------------------------------------------------------+
| KEY                   | 测试数据                   | 可否为空 | > 描述                                                                                 |
+-----------------------+----------------------------+----------+----------------------------------------------------------------------------------------+
| **pid**               | 310000                     | 不可以   | 游戏id                                                                                 |
+-----------------------+----------------------------+----------+----------------------------------------------------------------------------------------+
| **gameid**            | 310000                     | 不可以   | 游戏id                                                                                 |
+-----------------------+----------------------------+----------+----------------------------------------------------------------------------------------+
| **gameName**          | 安卓测试                   | 不可以   | 游戏名称                                                                               |
+-----------------------+----------------------------+----------+----------------------------------------------------------------------------------------+
| **screentype**        | ScreenType.SCREEN_PORTRAIT | 不可以   | 屏幕方向 横屏：1竖屏：2                                                                |
+-----------------------+----------------------------+----------+----------------------------------------------------------------------------------------+
| **fullScreen**        | true                       | 不可以   | 是否全屏，全屏则不带状态栏                                                             |
|                       |                            |          |                                                                                        |
|                       |                            |          | true（是）                                                                             |
|                       |                            |          |                                                                                        |
|                       |                            |          | false（否）                                                                            |
+-----------------------+----------------------------+----------+----------------------------------------------------------------------------------------+
| **oaid**              | String                     | 可以     | 传oaid的值，如果无法正确获取oaid的值，则传null                                         |
+-----------------------+----------------------------+----------+----------------------------------------------------------------------------------------+
| **assetFileName**     | String                     | 可以     | 使用oaid版本1.0.26+以上时，必须传该参数（该参数需向msa申请证书进行获取）。放到assets中 |
+-----------------------+----------------------------+----------+----------------------------------------------------------------------------------------+
| **oaidLibraryString** | String                     | 可以     | 使用oaid版本1.0.26+以上时，必须传该参数。根据msa文档1.0.26对应值为                     |
|                       |                            |          | nllvm1623827671，1.0.27对应值为                                                        |
|                       |                            |          | nllvm1630571663641560568，1.0.30及以上对应值为msaoaidsec                               |
+-----------------------+----------------------------+----------+----------------------------------------------------------------------------------------+

map参数示例：

+----------------------------------------------------------------------------+
| Map\<String, String\> dataMap = **new** HashMap\<String, String\>();       |
|                                                                            |
| dataMap.put(\"screentype\", screentype + \"\");                            |
|                                                                            |
| dataMap.put(\"fullScreen\", fullScreen + \"\");                            |
|                                                                            |
| dataMap.put(\"pid\", pid);                                                 |
|                                                                            |
| dataMap.put(\"gameid\", pid);                                              |
|                                                                            |
| dataMap.put(\"gameName\", gameName);                                       |
|                                                                            |
| dataMap.put(**\"oaid\"**,**\"hahaha\"**);                                  |
|                                                                            |
| dataMap.put(**\"assetFileName\"**,**\"com.example.oaidtest2.cert.pem\"**); |
|                                                                            |
| dataMap.put(**\"oaidLibraryString\"**,**\"hahahaha\"**);                   |
+----------------------------------------------------------------------------+

### 回调类AuthCallBack

说明：授权接口的回调对象。以下为接口中提供的方法：

+:---------------------------------+:-------------------------------------------------------------------------------------+
| > 方法                           | > 说明                                                                               |
+----------------------------------+--------------------------------------------------------------------------------------+
| > **onAuthSuccess()**            | > 授权成功(第三方审核，需要隐私政策后，才能采集个人信息。请在该方法后在采集个人信息) |
+----------------------------------+--------------------------------------------------------------------------------------+
| > **onAuthFailed()**             | > 授权失败                                                                           |
+----------------------------------+--------------------------------------------------------------------------------------+
| > **onTrackEvents(String         | > 详情请参考"数数回调说明"                                                           |
| > eventName, String data)**      |                                                                                      |
+----------------------------------+--------------------------------------------------------------------------------------+

##  登陆接口 

### 描述

此接口请在授权完成后的登录操作调用。（授权相关请查看 3.2）。

此接口调用方法如下(参照demo)：

+:----------------------------------------------------------------------------------------------------------------------------+
| **//正常登录。会回调XJGame.login中方法，不会XJGame.register回调中方法**                                                     |
|                                                                                                                             |
| **XJGame.login(Activity activity, LoginCallBack callBack);**                                                                |
|                                                                                                                             |
| **//该方法登录时也要调用，参考demo登录(用户注册成功后会自动登录，会回调XJGame.register中方法，不会回调XJGame.login中方法)** |
|                                                                                                                             |
| **XJGame.register(Activity activity, RegisterCallBack callBack);**                                                          |
+-----------------------------------------------------------------------------------------------------------------------------+

**（在之前有登陆过账户的情况下，不会弹出登录框，会使用最后一次登录的账号登录）**

接口所需参数：

+:-----------------------------+:-------------+:--------------------------------+
| > 参数                       | > 可否为空   | > 说明                          |
+------------------------------+--------------+---------------------------------+
| > **Activity activity**      | > 不可以     | > 上下文                        |
+------------------------------+--------------+---------------------------------+
| > **LoginCallBack callBack** | > 不可以     | > 处理登录结果的回调            |
+------------------------------+--------------+---------------------------------+
| > []{#_Toc16869              | > 不可以     | > 注册回调                      |
| > .anchor}**RegisterCallBack |              |                                 |
| > callBack**                 |              |                                 |
+------------------------------+--------------+---------------------------------+

### 登陆回调类LoginCallBack

说明：登陆接口的回调对象。以下为接口中提供的方法：

+:----------------------------------+:----------------------------------+
| > 方法                            | > 说明                            |
+-----------------------------------+-----------------------------------+
| **onLoginSuccess(UserInfo         | > 登录成功                        |
| mUserInfo)**                      |                                   |
+-----------------------------------+-----------------------------------+
| > **onLoginFail()**               | > 登录失败                        |
+-----------------------------------+-----------------------------------+
| > **onLoginCancel()**             | > 登录取消                        |
+-----------------------------------+-----------------------------------+

### 登陆成功返回参数类UserInfo

说明：登陆成功后通过登陆回调接口返回的对象。以下为对象属性：

  ---------------------------------- --------------------------------------
  字段                               说明

  **String userNo**                  用户唯一标识（**cp用户唯一标识码）**

  **String loginName**               用户名

  **String token**                   token（**用于登录验证）**

  **String loginType**               登录类型(18:微信)

  **String extra**                   其他(json格式，详见3.3.3.1)
  ---------------------------------- --------------------------------------

#### 登陆成功返回extra

  ---------------------------------- ------------------------------------------
  字段                               说明

  **String sex**                     性别

  **String country**                 国家

  **String province**                省份

  **String city**                    城市

  **String headImg**                 头像

  **String nickName**                昵称

  **String openId**                  用户在每个微信公众号或小程序下的唯一标识

  **String unionId**                 用户在微信开放平台下的唯一标识
  ---------------------------------- ------------------------------------------

##  支付接口 

### 描述

此接口请在登录完成后调用。

调用方法如下：

+:----------------------------------------------------------------------+
| \@Deprecated                                                          |
|                                                                       |
| ~~XJGame.payH5(Activity activity, BuildOrderRequest request,          |
| PayH5CallBack mPayH5CallBack);~~                                      |
+-----------------------------------------------------------------------+

**注**：如需监听支付异常信息可调用下面方法

  -----------------------------------------------------------------------
  pay(Activity activity, BuildOrderRequest request, PayCallBack
  callBack);

  -----------------------------------------------------------------------

接口所需参数：

+:-----------------------------+:--------------+:---------------------------------------+
| > 参数                       | 可否为空      | > 说明                                 |
+------------------------------+---------------+----------------------------------------+
| **Activity activity**        | 不可以        | > 上下文                               |
+------------------------------+---------------+----------------------------------------+
| > **BuildOrderRequest        | 不可以        | > 订单信息                             |
| > request**                  |               |                                        |
+------------------------------+---------------+----------------------------------------+
| **PayCallBack                | 不可以        | > 处理支付结果的回调（含支付异常信息） |
| callBack（New）**            |               |                                        |
+------------------------------+---------------+----------------------------------------+

### 支付回调类PayCallBack

说明：支付接口的回调对象，以下为接口的方法(用于处理页面逻辑。真正是否支付成功，由你们服务端通知你。请勿使用以下回调方法提示用户支付成功，支付失败，支付取消)：

  ----------------------------------- -----------------------------------
  方法                                               说明

  **onSuccess()**                                  支付成功

  **onFailed(XJPayException e)**                   支付失败

  **onCancel()**                                   支付取消
  ----------------------------------- -----------------------------------

### 订单信息类BuildOrderRequest

+:--------------------+:------------------+:----------------------------------:+
| > 字段              | > 可否为空        | > 说明                             |
+---------------------+-------------------+------------------------------------+
| amount              | > 不可以          | 订单金额(整形字符串)               |
+---------------------+-------------------+------------------------------------+
| companyOrderNo      | > 不可以          | **厂商订单ID（唯一）**             |
+---------------------+-------------------+------------------------------------+
| gamersRole          | > 不可以          | 游戏角色名                         |
+---------------------+-------------------+------------------------------------+
| productName         | > 不可以          | 商品名称                           |
+---------------------+-------------------+------------------------------------+
| serverNum           | > 不可以          | 区服ID                             |
+---------------------+-------------------+------------------------------------+
| extra               | > 不可以          | 扩展信息                           |
+---------------------+-------------------+------------------------------------+
| serverName          | > 不可以          | 区服名称                           |
+---------------------+-------------------+------------------------------------+
| gamersRoleId        | > 不可以          | 角色id                             |
+---------------------+-------------------+------------------------------------+
| gamersGrade         | > 不可以          | 角色等级                           |
+---------------------+-------------------+------------------------------------+
| userNo              | 不可以            | 用户唯一标志（可从登录信息中获取） |
+---------------------+-------------------+------------------------------------+
| loginName           | 不可以            | 登录账号（可从登录信息中获取）     |
+---------------------+-------------------+------------------------------------+

使用示例如下：

+-----------------------------------------------------------------------+
| BuildOrderRequest request = new BuildOrderRequest();                  |
|                                                                       |
| request.setAmount(Long.parseLong(amount));                            |
|                                                                       |
| request.setCompanyOrderNo(orderId);                                   |
|                                                                       |
| request.setGamersRole(playerName);                                    |
|                                                                       |
| request.setProductName(productName);                                  |
|                                                                       |
| request.setServerNum(serverNum);                                      |
|                                                                       |
| request.setExtra(extra);                                              |
|                                                                       |
| request.setServerName(serverName);                                    |
|                                                                       |
| request.setGamersRoleId(gamesRoleId);                                 |
|                                                                       |
| request.setGamersGrade(gamesGrade);                                   |
|                                                                       |
| if (userInfo!=null) {                                                 |
|                                                                       |
| request.setUserNo(userInfo.getUserNo());                              |
|                                                                       |
| request.setLoginName(userInfo.getLoginName());                        |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+

## 提交角色信息接口 

### 描述

此接口必须在**登录成功之后**调用。

调用方法如下：

  -----------------------------------------------------------------------
  **XJGame.submitUserGameRole(Context context,UserGameRoleRequest
  request);**

  -----------------------------------------------------------------------

接口所需参数：

  --------------------------- ----------------- -------------------------
             参数                 可否为空                说明

      **Context context**          不可以                上下文

     **UserGameRoleRequest         不可以               角色信息
           request**                            
  --------------------------- ----------------- -------------------------

### 获取角色信息类UserGameRoleRequest 

  ----------------------- ----------------------- ------------------------------------
           参数                  可否为空                         说明

      **gamersGrade**             不可以                        游戏等级

      **gamersRole**              不可以                        角色名称

          **pid**                 不可以                         游戏ID

        **gameId**                不可以                         游戏ID

     **gamersRoleId**             不可以                      玩家角色 ID

       **serverNum**              不可以                         区服ID

      **serverName**              不可以                        区服名称

        **userNo**                不可以           用户唯一标志（可从登录信息中获取）

       **loginName**              不可以             登录账号（可从登录信息中获取）
  ----------------------- ----------------------- ------------------------------------

使用示例：

+:----------------------------------------------------------------------+
| UserGameRoleRequest request = new UserGameRoleRequest();              |
|                                                                       |
| if (userInfo!=null) {                                                 |
|                                                                       |
| request.setUserNo(userInfo.getUserNo());                              |
| request.setLoginName(userInfo.getLoginName());                        |
|                                                                       |
| }                                                                     |
|                                                                       |
| request.setGamersGrade(gameGrade);                                    |
|                                                                       |
| request.setGamersRole(gameRoleName);                                  |
|                                                                       |
| request.setPid(pid);                                                  |
|                                                                       |
| request.setGameId(pid);                                               |
|                                                                       |
| request.setGamersRoleId(gameRoleId);                                  |
|                                                                       |
| request.setServerNum(serverNum);                                      |
|                                                                       |
| request.setServerName(serverName);                                    |
+-----------------------------------------------------------------------+

##  应用退出接口

此接口请在程序退出的时候调用，此接口调用方法如下：

  -----------------------------------------------------------------------
  XJGame.exit(ExitCallBack exitCallBack);

  -----------------------------------------------------------------------

接口所需参数：

+:----------------------------+:--------------+:-------------------------------------------------+
| > 参数                      | 可否为空      | > 说明                                           |
+-----------------------------+---------------+--------------------------------------------------+
| ExitCallBack exitCallBack   | 不可以        | > 处理退出结果的回调                             |
|                             |               | >                                                |
|                             |               | > （**开发人员可在此接口中处理自身的逻辑代码**） |
+-----------------------------+---------------+--------------------------------------------------+

##  注销登录接口

使用下面此种方式。

  -----------------------------------------------------------------------
  XJGame.logoutAccount();

  -----------------------------------------------------------------------

## 切换登录接口

使用下面此种方式。

  -----------------------------------------------------------------------
  XJGame.switchAccount(mContext);

  -----------------------------------------------------------------------

注销登录和切换登录接收回调：

  -----------------------------------------------------------------------
  XJGame.registerLogoutCallBack(LogoutAccountCallBack
  logoutAccountCallBack);

  -----------------------------------------------------------------------

游戏需要正确处理SDK可能会产生的注销登录、切换登录行为的回调

## 生命周期函数

Application 生命周期函数

  -----------------------------------------------------------------------
  **void** onCreate(Application application);

  -----------------------------------------------------------------------

Activity生命周期函数

+-----------------------------------------------------------------------+
| **void** onResume(this);                                              |
|                                                                       |
| **void** onPause();                                                   |
|                                                                       |
| **void** onActivityResult(**int** requestCode, **int** resultCode,    |
| Intent data);                                                         |
|                                                                       |
| **void** onConfigurationChanged(Configuration newConfig);             |
+-----------------------------------------------------------------------+

调用示例：

+-----------------------------------------------------------------------+
| *// 在onResume里调用*                                                 |
|                                                                       |
| \@Override                                                            |
|                                                                       |
| **protected void** onResume() {                                       |
|                                                                       |
| **super**.onResume();                                                 |
|                                                                       |
| XJGame.*onResume*(this);                                              |
|                                                                       |
| }                                                                     |
|                                                                       |
| */ 在onPause里调用*                                                   |
|                                                                       |
| \@Override                                                            |
|                                                                       |
| **protected void** onPause() {                                        |
|                                                                       |
| **super**.onPause();                                                  |
|                                                                       |
| XJGame.*onPause*();                                                   |
|                                                                       |
| }                                                                     |
|                                                                       |
| \@Override                                                            |
|                                                                       |
| **protected void** onActivityResult(**int** requestCode, **int**      |
| resultCode, Intent data) {                                            |
|                                                                       |
| XJGame.*onActivityResult*(requestCode,resultCode,data);               |
|                                                                       |
| }                                                                     |
|                                                                       |
| \@Override                                                            |
|                                                                       |
| **public void** onConfigurationChanged(Configuration newConfig) {     |
|                                                                       |
| **super**.onConfigurationChanged(newConfig);                          |
|                                                                       |
| XJGame.*onConfigurationChanged*(newConfig);                           |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+

#  注意事项

## 所有 SDK 接口调用 都需要在调用Application初始化、授权接口成功以后才能继续执行

## 接口请在主线程调用

## Apk请勿加固

[]{#_Toc11779 .anchor}**4.4**
如遇到因权限问题,文件问题造成APP闪退，请将compileSdkVersion,buildToolsVersion,targetSdkVersion改为30

## Apk需支持 V2 或V2以上签名能力
